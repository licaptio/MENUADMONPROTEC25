<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>INVENTARIO DE BOLSA PL√ÅSTICA</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #f4f4f4;
    margin: 0;
    padding: 20px;
  }
h2 {
  text-align: center;
  background: #222;
  color: white;
  padding: 12px;
  border-radius: 8px;
  margin: 0 auto 20px auto;
  max-width: 750px;
}

table {
  width: 100%;
  max-width: 750px;
  margin: auto;
  border-collapse: collapse;
  background: white;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

  th, td {
    border: 1px solid #ddd;
    padding: 6px;
    text-align: center;
    font-size: 14px;
  }
  th {
    background: #333;
    color: white;
  }
  tr:nth-child(even) { background: #f9f9f9; }

  input[type=text] {
    width: 100%;
    border: none;
    text-align: right;
    font-size: 14px;
    padding: 2px;
    box-sizing: border-box;
  }

  .btn { padding: 12px; margin: 6px 2px; border: none; color: white; font-size: 14px; cursor: pointer; border-radius: 5px; width: 100%; max-width: 250px; }
  .btn-blue { background: #007bff; } .btn-blue:hover { background: #0056b3; }
  .btn-red { background: #dc3545; } .btn-red:hover { background: #b52a37; }
  .btn-container { display: flex; flex-direction: column; align-items: center; gap: 6px; margin-bottom: 20px; }

  /* Estilo para los separadores */
  .separador {
    background: #6a1b9a !important;
    color: white;
    font-weight: bold;
    text-align: left;
  }
</style>
</head>
<body>

<h2>INVENTARIO DE BOLSA PL√ÅSTICA</h2>
<table id="tabla">
  <thead>
    <tr>
      <th>CONCEPTO</th>
      <th>PEDIDO</th>
      <th>KGS</th>
      <th>PESO TOTAL</th>
    </tr>
  </thead>
  <tbody id="tabla-cuerpo"></tbody>
</table>

<div class="btn-container">
  <button class="btn btn-blue" onclick="generarImagen()">üñºÔ∏è Generar Imagen Pedido</button>
  <button class="btn btn-red" onclick="limpiarPedidos()">üßπ Limpiar Pedidos</button>
</div>

<script>
// Datos agrupados
const data = [
  { group: "BOLSA NATURAL CORTADA", items: ["6X12 NAT","8X12 NAT","10X20","10X25","12X20","14X20","15X25","18X26","20X30","25X35","25X40","30X50","30X60 CAL 300","40X60","50X70","60X90","70X90","90X1.2"]},
  { group: "BOLSA CAMISETA POLIPAPEL BIO", items: ["POLIPAPEL BIO MINI","POLIPAPEL BIO CH","POLIPAPEL BIO MED","POLIPAPEL BIO GRAD","POLIPAPEL BIO JUMBO"]},
  { group: "BOLSA CAMISETA POLISEDA", items: ["POLISEDA MINI","POLISEDA CH","POLISEDA MED","POLISEDA GRAD"]},
  { group: "BOLSA CAMISETA BAJA NEGRA", items: ["CAMISETA BD NEGRA CH","CAMISETA BD NEGRA MED","CAMISETA BD NEGRA GRAD"]},
  { group: "ROLLO DE ALTA", items: ["15X26","18X26","20X30","20X30 C120","25X35","25X40","30X40","30X50","40X60","50X70"]},
  { group: "ROLLO ALTA TIPO AMERICANO", items: ["20X30 USA","25X40 USA"]},
  { group: "BOLSA BASURA", items: ["50X70","70X90","90X120"]}
];

// Render tabla principal
const tbody = document.getElementById("tabla-cuerpo");

data.forEach(section => {
  const sep = document.createElement("tr");
  sep.innerHTML = `<th colspan="4" class="separador">${section.group}</th>`;
  tbody.appendChild(sep);

  section.items.forEach(concepto => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${concepto}</td>
      <td><input type="text" inputmode="numeric" pattern="[0-9]*" oninput="validarNumero(this)"></td>
      <td>25</td>
      <td class="pesoTotal">0</td>
    `;
    tbody.appendChild(tr);
  });
});

// Validar solo n√∫meros enteros
function validarNumero(input){
  input.value = input.value.replace(/\D/g, ""); // Solo d√≠gitos
  calcPeso(input);
}

// Calcular peso por fila
function calcPeso(input){
  const pedido = parseInt(input.value) || 0;
  const kgs = 25;
  const peso = pedido * kgs;
  input.parentElement.parentElement.querySelector(".pesoTotal").textContent = peso;
}

// Imagen con separadores incluidos
function generarImagen(){
  let contenido = "";
  data.forEach(section => {
    let filas = "";
    section.items.forEach(item => {
      const tr = Array.from(document.querySelectorAll("#tabla tbody tr"))
  .find(r => r.cells[0] && r.cells[0].tagName === "TD" && r.cells[0].textContent.trim() === item);

      if(tr){
        const ped = tr.cells[1].querySelector("input").value;
        const peso = tr.cells[3].textContent;
        if(ped > 0){
          filas += `<tr><td>${item}</td><td>${ped}</td><td>${peso}</td></tr>`;
        }
      }
    });
    if(filas){
      contenido += `
        <tr><th colspan="3" style="background:#6a1b9a;color:white;text-align:left;">${section.group}</th></tr>
        ${filas}
      `;
    }
  });

  if(contenido === ""){ alert("No hay pedidos"); return; }

  const win=window.open("","","width=600,height=800");
  win.document.write(`
    <html><head><title>Pedido</title></head>
    <body style="font-family:Arial;padding:20px;">
    <h2 style="text-align:center;">ORDEN DE COMPRA <br> PROVEEDORA DE DULCES Y DESECHABLES</h2>
    <table border="1" cellspacing="0" cellpadding="6" style="width:100%;border-collapse:collapse;">
      <tr><th>CONCEPTO</th><th>PEDIDO</th><th>PESO TOTAL</th></tr>
      ${contenido}
    </table>
    <p style="text-align:center;margin-top:20px;">üìå Copiar y enviar por WhatsApp</p>
    <p style="text-align:center;font-size:12px;color:gray;margin-top:30px;">powered by PROVSOFT</p>
    </body></html>`);
  win.document.close();
}

// Limpiar
function limpiarPedidos(){
  document.querySelectorAll("#tabla tbody tr input").forEach(inp=>{inp.value=""; calcPeso(inp);});
}

// Mover con flechas ‚Üë ‚Üì
document.addEventListener("keydown", function(e){
  if(e.target.tagName === "INPUT"){
    const inputs = Array.from(document.querySelectorAll("#tabla tbody tr input"));
    const idx = inputs.indexOf(e.target);
    if(e.key === "ArrowDown"){
      e.preventDefault();
      if(idx < inputs.length-1) inputs[idx+1].focus();
    }
    if(e.key === "ArrowUp"){
      e.preventDefault();
      if(idx > 0) inputs[idx-1].focus();
    }
  }
});
</script>
</body>
</html>

